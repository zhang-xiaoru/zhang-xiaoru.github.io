<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>The usual case of cross-validation with random samples is not suitable for time series data since the shuffling process will include future data to forecast values in the past.</p> <p>One of the way to make corss validation set for time series data is to chose segments of series as different traning sets. he successive traning sets need to be supersets of those that come beofre. Then select the following piece of sereis of the traning set as the vlidation set.</p> <p>Example using <code class="language-plaintext highlighter-rouge">sklearn.model_selection.TimeSeriesSplit</code></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">Time</span> <span class="n">SeriesSplit</span>

<span class="c1"># Create series dataset
</span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>

<span class="c1"># Create 5 fold spliting
</span><span class="n">tscv</span> <span class="o">=</span> <span class="nc">TimeSeriesSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># print the split result
</span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">tscv</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Split </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Train indices: </span><span class="si">{</span><span class="n">train_index</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Test indices: </span><span class="si">{</span><span class="n">test_index</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">TimeSeriesSplit</code> takes serval parameters:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">n_split</code>: number of splits</li> <li> <code class="language-plaintext highlighter-rouge">max_train_size</code>: maximum size of a single traning set, <code class="language-plaintext highlighter-rouge">default=None</code> </li> <li> <code class="language-plaintext highlighter-rouge">test_size</code>: size of the test set, <code class="language-plaintext highlighter-rouge">default=None</code>. If <code class="language-plaintext highlighter-rouge">default</code>, the isze of test set is <code class="language-plaintext highlighter-rouge">n_samples // (n_splits + 1)</code>, which is maximum test size with <code class="language-plaintext highlighter-rouge">gap=0</code> </li> <li> <code class="language-plaintext highlighter-rouge">gap</code>: Number of samples excluded after and before the train set and test set</li> </ul> <p><code class="language-plaintext highlighter-rouge">split</code> method returns a iterator for generated indices for each splited traning and test set</p> <ul> <li> <code class="language-plaintext highlighter-rouge">X</code>: array-like of shape (n_samples, n_features), where n_sample is number of samples and n_features is the number of features.</li> <li> <code class="language-plaintext highlighter-rouge">y</code>: <code class="language-plaintext highlighter-rouge">defualt=None</code> </li> <li> <code class="language-plaintext highlighter-rouge">group</code>: <code class="language-plaintext highlighter-rouge">defult=None</code> </li> </ul> </body></html>